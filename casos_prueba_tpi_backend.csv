ID;ROL;MICROSERVICIO;MÉTODO;ENDPOINT;DESCRIPCIÓN;ENTRADA(JSON);TOKEN/ROL REQUERIDO;RESPUESTA ESPERADA;HTTP STATUS;VALIDACIONES CLAVE;RESULTADO(OK/FAIL)
001;cliente;servicio-gestion;GET;/api-gestion/clientes;Listar todos los clientes del sistema;N/A;Bearer token JWT (cualquier rol);Lista de clientes con id, nombre, apellido, email, telefono, cuil;200;Debe retornar array vacío si no hay clientes. Debe incluir paginación si hay muchos registros.;
002;cliente;servicio-gestion;GET;/api-gestion/clientes/1;Obtener cliente por ID existente;N/A;Bearer token JWT (cualquier rol);Cliente con id=1 con todos sus datos: {"id":1,"nombre":"Juan","apellido":"Pérez","email":"juan@mail.com","telefono":"3516789012","cuil":"20123456789"};200;ID debe existir en BD. Validar estructura completa del JSON.;
003;cliente;servicio-gestion;GET;/api-gestion/clientes/999;Obtener cliente por ID inexistente;N/A;Bearer token JWT (cualquier rol);Cuerpo vacío o mensaje de error;404;Debe retornar 404 Not Found cuando el ID no existe.;
004;operador;servicio-gestion;POST;/api-gestion/clientes;Crear nuevo cliente con datos válidos;{"nombre":"María","apellido":"González","email":"maria@mail.com","telefono":"3517890123","cuil":"27345678901"};Bearer token JWT (rol operador);Cliente creado con ID autogenerado: {"id":2,"nombre":"María","apellido":"González","email":"maria@mail.com","telefono":"3517890123","cuil":"27345678901"};200;Validar @NotBlank en nombre/apellido, @Email en email, @Pattern en CUIL. Email debe ser único.;
005;operador;servicio-gestion;POST;/api-gestion/clientes;Crear cliente con email duplicado;{"nombre":"Pedro","apellido":"Lopez","email":"maria@mail.com","telefono":"3518901234","cuil":"20456789012"};Bearer token JWT (rol operador);Error de validación: {"timestamp":"2024-01-15T10:30:00","status":409,"error":"Conflict","message":"El email ya existe en el sistema","path":"/api-gestion/clientes"};409;Debe detectar constraint de email único en BD.;
006;operador;servicio-gestion;POST;/api-gestion/clientes;Crear cliente con datos inválidos (email mal formado);{"nombre":"Ana","apellido":"Martinez","email":"ana.mail.com","telefono":"3519012345","cuil":"27567890123"};Bearer token JWT (rol operador);Error de validación: {"timestamp":"2024-01-15T10:30:00","status":400,"error":"Bad Request","message":"El email debe ser válido","path":"/api-gestion/clientes"};400;Validación @Email debe fallar. Debe retornar detalles del campo inválido.;
007;operador;servicio-gestion;POST;/api-gestion/clientes;Crear cliente con campos obligatorios faltantes;{"apellido":"Fernández","email":"carlos@mail.com"};Bearer token JWT (rol operador);Error de validación: {"timestamp":"2024-01-15T10:30:00","status":400,"error":"Bad Request","message":"El nombre es obligatorio","path":"/api-gestion/clientes"};400;Validación @NotBlank debe detectar campo nombre faltante.;
008;operador;servicio-gestion;PUT;/api-gestion/clientes/1;Actualizar cliente existente con datos válidos;{"nombre":"Juan Carlos","apellido":"Pérez","email":"juancarlos@mail.com","telefono":"3516789999","cuil":"20123456789"};Bearer token JWT (rol operador);Cliente actualizado: {"id":1,"nombre":"Juan Carlos","apellido":"Pérez","email":"juancarlos@mail.com","telefono":"3516789999","cuil":"20123456789"};200;Debe actualizar todos los campos. ID debe existir previamente.;
009;operador;servicio-gestion;PUT;/api-gestion/clientes/999;Actualizar cliente inexistente;{"nombre":"Inexistente","apellido":"Usuario","email":"inexistente@mail.com","telefono":"3510000000","cuil":"20000000000"};Bearer token JWT (rol operador);Error: {"timestamp":"2024-01-15T10:30:00","status":404,"error":"Not Found","message":"Cliente no encontrado con ID: 999","path":"/api-gestion/clientes/999"};404;Debe validar que el ID exista antes de actualizar.;
010;operador;servicio-gestion;DELETE;/api-gestion/clientes/1;Eliminar cliente existente;N/A;Bearer token JWT (rol operador);Cuerpo vacío (No Content);204;Debe eliminar lógica o físicamente el cliente. Validar cascada en contenedores asociados.;
011;operador;servicio-gestion;DELETE;/api-gestion/clientes/999;Eliminar cliente inexistente;N/A;Bearer token JWT (rol operador);Error: {"timestamp":"2024-01-15T10:30:00","status":404,"error":"Not Found","message":"Cliente no encontrado con ID: 999","path":"/api-gestion/clientes/999"};404;Debe retornar 404 si el cliente no existe.;
012;cliente;servicio-gestion;GET;/api-gestion/contenedores;Listar todos los contenedores;N/A;Bearer token JWT (cualquier rol);Lista de contenedores: [{"id":1,"codigoIdentificacion":"CONT-001","peso":1500.5,"volumen":2.5,"cliente":{"id":1}}];200;Debe incluir relación con cliente (lazy loading). Validar performance con muchos registros.;
013;cliente;servicio-gestion;GET;/api-gestion/contenedores/cliente/1;Listar contenedores de un cliente específico;N/A;Bearer token JWT (cualquier rol);Lista filtrada de contenedores del cliente con id=1;200;Debe aplicar filtro WHERE id_cliente = 1. Retornar array vacío si cliente no tiene contenedores.;
014;cliente;servicio-gestion;GET;/api-gestion/contenedores/codigo/CONT-001;Buscar contenedor por código existente;N/A;Bearer token JWT (cualquier rol);Contenedor: {"id":1,"codigoIdentificacion":"CONT-001","peso":1500.5,"volumen":2.5,"cliente":{"id":1}};200;Código debe ser único. Búsqueda case-sensitive.;
015;cliente;servicio-gestion;GET;/api-gestion/contenedores/codigo/CONT-999;Buscar contenedor por código inexistente;N/A;Bearer token JWT (cualquier rol);Cuerpo vacío;404;Debe retornar 404 Not Found si el código no existe.;
016;cliente;servicio-gestion;GET;/api-gestion/contenedores/1/estado;Obtener estado de contenedor por ID;N/A;Bearer token JWT (cualquier rol);Estado del contenedor: {"idContenedor":1,"codigoIdentificacion":"CONT-001","estadoActual":"EN_TRANSITO","solicitudActual":{"id":1,"numeroSeguimiento":"SEG-2024-001"}};200;Debe consultar servicio-logistica para obtener estado actual de la solicitud asociada.;
017;cliente;servicio-gestion;GET;/api-gestion/contenedores/codigo/CONT-001/estado;Obtener estado de contenedor por código;N/A;Bearer token JWT (cualquier rol);Estado del contenedor: {"idContenedor":1,"codigoIdentificacion":"CONT-001","estadoActual":"EN_TRANSITO","solicitudActual":{"id":1,"numeroSeguimiento":"SEG-2024-001"}};200;Mismo que endpoint anterior pero busca por código en vez de ID.;
018;operador;servicio-gestion;POST;/api-gestion/contenedores;Crear contenedor con datos válidos;{"codigoIdentificacion":"CONT-002","peso":2000.0,"volumen":3.0,"cliente":{"id":1}};Bearer token JWT (rol operador);Contenedor creado: {"id":2,"codigoIdentificacion":"CONT-002","peso":2000.0,"volumen":3.0,"cliente":{"id":1}};200;Validar @NotBlank en código, @DecimalMin en peso/volumen. Cliente debe existir (@NotNull).;
019;operador;servicio-gestion;POST;/api-gestion/contenedores;Crear contenedor con código duplicado;{"codigoIdentificacion":"CONT-001","peso":1800.0,"volumen":2.8,"cliente":{"id":1}};Bearer token JWT (rol operador);Error: {"timestamp":"2024-01-15T10:30:00","status":409,"error":"Conflict","message":"El código de identificación ya existe","path":"/api-gestion/contenedores"};409;Constraint UNIQUE en codigoIdentificacion debe fallar.;
020;operador;servicio-gestion;POST;/api-gestion/contenedores;Crear contenedor con cliente inexistente;{"codigoIdentificacion":"CONT-003","peso":1500.0,"volumen":2.0,"cliente":{"id":999}};Bearer token JWT (rol operador);Error: {"timestamp":"2024-01-15T10:30:00","status":404,"error":"Not Found","message":"Cliente no encontrado con ID: 999","path":"/api-gestion/contenedores"};404;Foreign key constraint debe detectar cliente inexistente.;
021;operador;servicio-gestion;POST;/api-gestion/contenedores;Crear contenedor con peso negativo;{"codigoIdentificacion":"CONT-004","peso":-100.0,"volumen":2.0,"cliente":{"id":1}};Bearer token JWT (rol operador);Error: {"timestamp":"2024-01-15T10:30:00","status":400,"error":"Bad Request","message":"El peso del contenedor debe ser mayor a 0","path":"/api-gestion/contenedores"};400;Validación @DecimalMin(value="0.1") debe fallar.;
022;operador;servicio-gestion;PUT;/api-gestion/contenedores/1;Actualizar contenedor existente;{"codigoIdentificacion":"CONT-001-MOD","peso":1600.0,"volumen":2.6,"cliente":{"id":1}};Bearer token JWT (rol operador);Contenedor actualizado: {"id":1,"codigoIdentificacion":"CONT-001-MOD","peso":1600.0,"volumen":2.6,"cliente":{"id":1}};200;Debe permitir cambiar todos los campos. Validar que no esté en tránsito si se cambian dimensiones.;
023;operador;servicio-gestion;DELETE;/api-gestion/contenedores/1;Eliminar contenedor existente;N/A;Bearer token JWT (rol operador);Cuerpo vacío (No Content);204;Validar que no tenga solicitudes activas antes de eliminar.;
024;operador;servicio-gestion;GET;/api-gestion/depositos;Listar todos los depósitos;N/A;Bearer token JWT (cualquier rol);Lista de depósitos: [{"id":1,"nombre":"Depósito Central","direccion":"Av. Principal 123","latitud":-31.4201,"longitud":-64.1888}];200;Debe retornar todos los depósitos con coordenadas GPS válidas.;
025;operador;servicio-gestion;GET;/api-gestion/depositos/1;Obtener depósito por ID;N/A;Bearer token JWT (cualquier rol);Depósito: {"id":1,"nombre":"Depósito Central","direccion":"Av. Principal 123","latitud":-31.4201,"longitud":-64.1888};200;ID debe existir en BD.;
026;operador;servicio-gestion;POST;/api-gestion/depositos;Crear nuevo depósito;{"nombre":"Depósito Norte","direccion":"Ruta 9 Km 5","latitud":-31.3500,"longitud":-64.1500};Bearer token JWT (rol operador);Depósito creado: {"id":2,"nombre":"Depósito Norte","direccion":"Ruta 9 Km 5","latitud":-31.3500,"longitud":-64.1500};200;Validar campos obligatorios. Latitud/longitud deben estar en rangos válidos.;
027;operador;servicio-gestion;PUT;/api-gestion/depositos/1;Actualizar depósito existente;{"nombre":"Depósito Central Renovado","direccion":"Av. Principal 123","latitud":-31.4201,"longitud":-64.1888};Bearer token JWT (rol operador);Depósito actualizado con nuevos datos;200;Debe permitir modificar todos los campos.;
028;operador;servicio-gestion;DELETE;/api-gestion/depositos/1;Eliminar depósito existente;N/A;Bearer token JWT (rol operador);Cuerpo vacío (No Content);204;Validar que no esté siendo usado en rutas activas.;
029;operador;servicio-gestion;GET;/api-gestion/tarifas;Listar todas las tarifas;N/A;Bearer token JWT (cualquier rol);Lista de tarifas: [{"id":1,"nombre":"Tarifa Estándar","pesoMinimo":0.0,"pesoMaximo":1000.0,"volumenMinimo":0.0,"volumenMaximo":5.0,"precioBase":5000.0}];200;Debe incluir rangos de peso/volumen y precios.;
030;operador;servicio-gestion;GET;/api-gestion/tarifas/aplicable?peso=500&volumen=2.5;Buscar tarifa aplicable para carga específica;N/A;Bearer token JWT (cualquier rol);Tarifa aplicable: {"id":1,"nombre":"Tarifa Estándar","precioBase":5000.0};200;Debe buscar la tarifa donde peso y volumen estén dentro de los rangos definidos.;
031;operador;servicio-gestion;GET;/api-gestion/tarifas/aplicable?peso=10000&volumen=50;Buscar tarifa aplicable sin coincidencias;N/A;Bearer token JWT (cualquier rol);Cuerpo vacío;404;Debe retornar 404 si no existe tarifa que cubra los valores solicitados.;
032;operador;servicio-gestion;POST;/api-gestion/tarifas;Crear nueva tarifa;{"nombre":"Tarifa Premium","pesoMinimo":1000.0,"pesoMaximo":5000.0,"volumenMinimo":5.0,"volumenMaximo":20.0,"precioBase":15000.0};Bearer token JWT (rol operador);Tarifa creada con ID autogenerado;200;Validar que rangos sean coherentes (min < max). No deben solaparse con otras tarifas.;
033;operador;servicio-gestion;PUT;/api-gestion/tarifas/1;Actualizar tarifa existente;{"nombre":"Tarifa Estándar Plus","pesoMinimo":0.0,"pesoMaximo":1000.0,"volumenMinimo":0.0,"volumenMaximo":5.0,"precioBase":5500.0};Bearer token JWT (rol operador);Tarifa actualizada;200;Debe permitir ajustar precios y rangos.;
034;operador;servicio-gestion;DELETE;/api-gestion/tarifas/1;Eliminar tarifa existente;N/A;Bearer token JWT (rol operador);Cuerpo vacío (No Content);204;Validar que no esté siendo usada en solicitudes activas.;
035;transportista;servicio-flota;GET;/api-flota/camiones;Listar todos los camiones;N/A;Bearer token JWT (cualquier rol);Lista de camiones: [{"patente":"AA123BB","nombreTransportista":"Transportes S.A.","telefonoTransportista":"3511234567","capacidadPeso":5000.0,"capacidadVolumen":30.0,"consumoCombustibleKm":0.35,"costoPorKm":150.0,"disponible":true}];200;Debe incluir capacidades, consumo, costos y disponibilidad.;
036;transportista;servicio-flota;GET;/api-flota/camiones/disponibles;Listar solo camiones disponibles;N/A;Bearer token JWT (cualquier rol);Lista filtrada de camiones con disponible=true;200;Filtro WHERE disponible = true. Útil para asignación de tramos.;
037;transportista;servicio-flota;GET;/api-flota/camiones/AA123BB;Buscar camión por patente existente;N/A;Bearer token JWT (cualquier rol);Camión: {"patente":"AA123BB","nombreTransportista":"Transportes S.A.","capacidadPeso":5000.0,"capacidadVolumen":30.0,"disponible":true};200;Patente es la clave primaria. Búsqueda case-sensitive.;
038;transportista;servicio-flota;GET;/api-flota/camiones/ZZ999ZZ;Buscar camión por patente inexistente;N/A;Bearer token JWT (cualquier rol);Cuerpo vacío;404;Debe retornar 404 Not Found si la patente no existe.;
039;transportista;servicio-flota;GET;/api-flota/camiones/aptos?peso=2000&volumen=15;Buscar camiones aptos para carga específica;N/A;Bearer token JWT (cualquier rol);Lista de camiones donde capacidadPeso >= 2000 Y capacidadVolumen >= 15 Y disponible = true;200;Filtro complejo: capacidades suficientes + disponibilidad. Si no hay coincidencias, retorna array vacío.;
040;operador;servicio-flota;POST;/api-flota/camiones;Crear nuevo camión con datos válidos;{"patente":"BB456CC","nombreTransportista":"LogiTrans","telefonoTransportista":"3517654321","capacidadPeso":8000.0,"capacidadVolumen":40.0,"consumoCombustibleKm":0.42,"costoPorKm":180.0,"disponible":true};Bearer token JWT (rol operador);Camión creado: {"patente":"BB456CC","nombreTransportista":"LogiTrans","capacidadPeso":8000.0,"disponible":true};200;Validar @NotBlank en patente/nombre, @Positive en consumo, @PositiveOrZero en capacidades.;
041;operador;servicio-flota;POST;/api-flota/camiones;Crear camión con patente duplicada;{"patente":"AA123BB","nombreTransportista":"Otro Transportista","capacidadPeso":6000.0,"capacidadVolumen":35.0,"consumoCombustibleKm":0.38,"costoPorKm":160.0,"disponible":true};Bearer token JWT (rol operador);Error: {"timestamp":"2024-01-15T10:30:00","status":409,"error":"Conflict","message":"La patente ya existe en el sistema","path":"/api-flota/camiones"};409;Constraint PRIMARY KEY en patente debe fallar.;
042;operador;servicio-flota;POST;/api-flota/camiones;Crear camión con capacidad negativa;{"patente":"CC789DD","nombreTransportista":"Transportes XYZ","capacidadPeso":-1000.0,"capacidadVolumen":25.0,"consumoCombustibleKm":0.40,"costoPorKm":170.0,"disponible":true};Bearer token JWT (rol operador);Error: {"timestamp":"2024-01-15T10:30:00","status":400,"error":"Bad Request","message":"La capacidad de peso debe ser mayor o igual a 0","path":"/api-flota/camiones"};400;Validación @PositiveOrZero debe fallar.;
043;operador;servicio-flota;PUT;/api-flota/camiones/AA123BB;Actualizar camión existente;{"patente":"AA123BB","nombreTransportista":"Transportes S.A. Renovado","telefonoTransportista":"3511234999","capacidadPeso":5500.0,"capacidadVolumen":32.0,"consumoCombustibleKm":0.33,"costoPorKm":155.0,"disponible":true};Bearer token JWT (rol operador);Camión actualizado con nuevos valores;200;Permite modificar datos operativos. No debe cambiar la patente (es PK).;
044;transportista;servicio-flota;PATCH;/api-flota/camiones/AA123BB/disponibilidad?disponible=false;Cambiar disponibilidad de camión a no disponible;N/A;Bearer token JWT (rol transportista);Camión actualizado: {"patente":"AA123BB","disponible":false};200;Útil para marcar camión en mantenimiento o fuera de servicio. Solo actualiza campo disponible.;
045;transportista;servicio-flota;PATCH;/api-flota/camiones/ZZ999ZZ/disponibilidad?disponible=true;Cambiar disponibilidad de camión inexistente;N/A;Bearer token JWT (rol transportista);Error: {"timestamp":"2024-01-15T10:30:00","status":404,"error":"Not Found","message":"Camión no encontrado con patente: ZZ999ZZ","path":"/api-flota/camiones/ZZ999ZZ/disponibilidad"};404;Debe validar existencia del camión antes de actualizar.;
046;operador;servicio-flota;DELETE;/api-flota/camiones/BB456CC;Eliminar camión existente;N/A;Bearer token JWT (rol operador);Cuerpo vacío (No Content);204;Validar que no tenga tramos asignados activos antes de eliminar.;
047;cliente;servicio-logistica;GET;/api-logistica/solicitudes;Listar todas las solicitudes;N/A;Bearer token JWT (cualquier rol);Lista de solicitudes: [{"id":1,"numeroSeguimiento":"SEG-2024-001","origenDireccion":"Origen 1","destinoDireccion":"Destino 1","estado":"PENDIENTE","idCliente":1,"idContenedor":1}];200;Debe incluir todas las solicitudes del sistema. Considerar paginación.;
048;cliente;servicio-logistica;GET;/api-logistica/solicitudes/1;Obtener solicitud por ID;N/A;Bearer token JWT (cualquier rol);Solicitud completa: {"id":1,"numeroSeguimiento":"SEG-2024-001","origenDireccion":"Origen 1","origenLatitud":-31.42,"origenLongitud":-64.19,"destinoDireccion":"Destino 1","destinoLatitud":-31.40,"destinoLongitud":-64.15,"estado":"PENDIENTE","idCliente":1,"idContenedor":1};200;ID debe existir. Incluye coordenadas GPS completas.;
049;cliente;servicio-logistica;GET;/api-logistica/solicitudes/999;Obtener solicitud por ID inexistente;N/A;Bearer token JWT (cualquier rol);Cuerpo vacío;404;Debe retornar 404 Not Found si el ID no existe.;
050;cliente;servicio-logistica;GET;/api-logistica/solicitudes/seguimiento/SEG-2024-001;Buscar solicitud por número de seguimiento;N/A;Bearer token JWT (cualquier rol);Solicitud: {"id":1,"numeroSeguimiento":"SEG-2024-001","estado":"PENDIENTE"};200;Número de seguimiento es único. Cliente usa esto para rastrear su envío.;
051;cliente;servicio-logistica;GET;/api-logistica/solicitudes/seguimiento/SEG-INVALIDO;Buscar solicitud por seguimiento inexistente;N/A;Bearer token JWT (cualquier rol);Cuerpo vacío;404;Debe retornar 404 si el número de seguimiento no existe.;
052;cliente;servicio-logistica;GET;/api-logistica/solicitudes/cliente/1;Listar solicitudes de un cliente específico;N/A;Bearer token JWT (rol cliente con id=1);Lista filtrada de solicitudes del cliente 1;200;Filtro WHERE id_cliente = 1. Cliente solo debe ver sus propias solicitudes.;
053;cliente;servicio-logistica;GET;/api-logistica/solicitudes/estado/PENDIENTE;Listar solicitudes por estado;N/A;Bearer token JWT (cualquier rol);Lista de solicitudes con estado = 'PENDIENTE';200;Estados válidos: PENDIENTE, EN_TRANSITO, ENTREGADO, CANCELADO. Útil para dashboard operativo.;
054;operador;servicio-logistica;POST;/api-logistica/solicitudes;Crear solicitud básica;{"numeroSeguimiento":"SEG-2024-002","origenDireccion":"Av. Colón 100","origenLatitud":-31.4200,"origenLongitud":-64.1888,"destinoDireccion":"Bv. San Juan 500","destinoLatitud":-31.4100,"destinoLongitud":-64.1700,"idCliente":1,"idContenedor":1};Bearer token JWT (rol operador);Solicitud creada: {"id":2,"numeroSeguimiento":"SEG-2024-002","estado":"PENDIENTE"};200;Validar @NotBlank en direcciones, @NotNull en coordenadas. Cliente y contenedor deben existir.;
055;operador;servicio-logistica;POST;/api-logistica/solicitudes;Crear solicitud con número de seguimiento duplicado;{"numeroSeguimiento":"SEG-2024-001","origenDireccion":"Origen X","origenLatitud":-31.42,"origenLongitud":-64.19,"destinoDireccion":"Destino Y","destinoLatitud":-31.40,"destinoLongitud":-64.15,"idCliente":1,"idContenedor":1};Bearer token JWT (rol operador);Error: {"timestamp":"2024-01-15T10:30:00","status":409,"error":"Conflict","message":"El número de seguimiento ya existe","path":"/api-logistica/solicitudes"};409;Constraint UNIQUE en numeroSeguimiento debe fallar.;
056;operador;servicio-logistica;POST;/api-logistica/solicitudes/completa;Crear solicitud completa con cliente y contenedor nuevos;{"numeroSeguimiento":"SEG-2024-003","origenDireccion":"Origen A","origenLatitud":-31.42,"origenLongitud":-64.19,"destinoDireccion":"Destino B","destinoLatitud":-31.40,"destinoLongitud":-64.15,"clienteNombre":"Roberto","clienteApellido":"Sanchez","clienteEmail":"roberto@mail.com","clienteTelefono":"3518765432","clienteCuil":"20678901234","contenedorCodigo":"CONT-005","contenedorPeso":1800.0,"contenedorVolumen":3.2};Bearer token JWT (rol operador);Respuesta completa: {"solicitudId":3,"numeroSeguimiento":"SEG-2024-003","clienteId":3,"clienteCreado":true,"contenedorId":3,"contenedorCreado":true};200;Debe crear cliente y contenedor si no existen, luego crear la solicitud. Transacción atómica.;
057;operador;servicio-logistica;POST;/api-logistica/solicitudes/completa;Crear solicitud completa con cliente existente;{"numeroSeguimiento":"SEG-2024-004","origenDireccion":"Origen C","origenLatitud":-31.42,"origenLongitud":-64.19,"destinoDireccion":"Destino D","destinoLatitud":-31.40,"destinoLongitud":-64.15,"idCliente":1,"contenedorCodigo":"CONT-006","contenedorPeso":2200.0,"contenedorVolumen":4.0};Bearer token JWT (rol operador);Respuesta: {"solicitudId":4,"numeroSeguimiento":"SEG-2024-004","clienteId":1,"clienteCreado":false,"contenedorId":4,"contenedorCreado":true};200;Usa cliente existente (idCliente=1), solo crea contenedor nuevo. Lógica condicional.;
058;operador;servicio-logistica;PUT;/api-logistica/solicitudes/1;Actualizar solicitud existente;{"numeroSeguimiento":"SEG-2024-001-MOD","origenDireccion":"Origen Modificado","origenLatitud":-31.42,"origenLongitud":-64.19,"destinoDireccion":"Destino Modificado","destinoLatitud":-31.40,"destinoLongitud":-64.15,"idCliente":1,"idContenedor":1};Bearer token JWT (rol operador);Solicitud actualizada;200;Validar que no esté EN_TRANSITO o ENTREGADO antes de modificar. Solo PENDIENTE es editable.;
059;operador;servicio-logistica;DELETE;/api-logistica/solicitudes/1;Eliminar solicitud existente;N/A;Bearer token JWT (rol operador);Cuerpo vacío (No Content);204;Validar que estado sea PENDIENTE o CANCELADO. No se puede eliminar si está EN_TRANSITO.;
060;operador;servicio-logistica;POST;/api-logistica/solicitudes/estimar-ruta;Estimar ruta con Google Maps API;{"idContenedor":1,"idCliente":1,"origenDireccion":"Av. Colón 100, Córdoba","origenLatitud":-31.4200,"origenLongitud":-64.1888,"destinoDireccion":"Bv. San Juan 500, Córdoba","destinoLatitud":-31.4100,"destinoLongitud":-64.1700,"pesoKg":1500.0,"volumenM3":2.5};Bearer token JWT (rol operador);Estimación: {"distanciaKm":5.8,"duracionMinutos":15,"costoEstimado":8750.0,"tarifaAplicada":{"id":1,"nombre":"Tarifa Estándar"},"camionesAptos":[{"patente":"AA123BB","capacidadPeso":5000.0}]};200;Llama a Google Maps API para calcular distancia/duración. Busca tarifa aplicable y camiones aptos. No crea rutas ni tramos.;
061;operador;servicio-logistica;POST;/api-logistica/solicitudes/estimar-ruta;Estimar ruta sin tarifa aplicable;{"idContenedor":1,"idCliente":1,"origenDireccion":"Origen","origenLatitud":-31.42,"origenLongitud":-64.19,"destinoDireccion":"Destino","destinoLatitud":-31.40,"destinoLongitud":-64.15,"pesoKg":50000.0,"volumenM3":100.0};Bearer token JWT (rol operador);Error: {"timestamp":"2024-01-15T10:30:00","status":404,"error":"Not Found","message":"No se encontró tarifa aplicable para peso 50000.0 y volumen 100.0","path":"/api-logistica/solicitudes/estimar-ruta"};404;Debe validar que exista tarifa que cubra los rangos solicitados.;
062;operador;servicio-logistica;POST;/api-logistica/solicitudes/estimar-ruta;Estimar ruta sin camiones aptos;{"idContenedor":1,"idCliente":1,"origenDireccion":"Origen","origenLatitud":-31.42,"origenLongitud":-64.19,"destinoDireccion":"Destino","destinoLatitud":-31.40,"destinoLongitud":-64.15,"pesoKg":1500.0,"volumenM3":2.5};Bearer token JWT (rol operador);Respuesta con camionesAptos = [];200;Si no hay camiones disponibles con capacidad suficiente, retorna array vacío pero no falla. Permite al operador ver el costo antes de adquirir camión.;
063;operador;servicio-logistica;POST;/api-logistica/solicitudes/1/asignar-ruta;Asignar ruta a solicitud;{"idContenedor":1,"idCliente":1,"origenDireccion":"Av. Colón 100, Córdoba","origenLatitud":-31.4200,"origenLongitud":-64.1888,"destinoDireccion":"Bv. San Juan 500, Córdoba","destinoLatitud":-31.4100,"destinoLongitud":-64.1700,"pesoKg":1500.0,"volumenM3":2.5};Bearer token JWT (rol operador);Solicitud con ruta asignada: {"id":1,"numeroSeguimiento":"SEG-2024-001","estado":"EN_TRANSITO","ruta":{"id":1,"distanciaKm":5.8,"duracionMinutos":15}};200;Crea ruta y tramos asociados. Cambia estado de solicitud a EN_TRANSITO. Transacción compleja.;
064;operador;servicio-logistica;POST;/api-logistica/solicitudes/999/asignar-ruta;Asignar ruta a solicitud inexistente;{"origenDireccion":"Origen","origenLatitud":-31.42,"origenLongitud":-64.19,"destinoDireccion":"Destino","destinoLatitud":-31.40,"destinoLongitud":-64.15,"pesoKg":1500.0,"volumenM3":2.5};Bearer token JWT (rol operador);Error: {"timestamp":"2024-01-15T10:30:00","status":404,"error":"Not Found","message":"Solicitud no encontrada con ID: 999","path":"/api-logistica/solicitudes/999/asignar-ruta"};404;Debe validar que la solicitud exista antes de asignar ruta.;
065;cliente;servicio-logistica;GET;/api-logistica/solicitudes/seguimiento-detallado/SEG-2024-001;Obtener seguimiento detallado por número;N/A;Bearer token JWT (rol cliente);Seguimiento completo: {"numeroSeguimiento":"SEG-2024-001","estadoSolicitud":"EN_TRANSITO","cliente":{"nombre":"Juan Pérez"},"contenedor":{"codigoIdentificacion":"CONT-001"},"rutas":[{"id":1,"distanciaKm":5.8,"tramos":[{"id":1,"origenDireccion":"Av. Colón 100","destinoDireccion":"Bv. San Juan 500","estado":"EN_TRANSITO","camionAsignado":"AA123BB"}]}]};200;Endpoint completo para seguimiento público. Incluye estado actual, rutas, tramos con camiones asignados. Cliente accede con número de seguimiento.;
066;cliente;servicio-logistica;GET;/api-logistica/solicitudes/seguimiento-detallado/SEG-INVALIDO;Obtener seguimiento detallado de seguimiento inexistente;N/A;Bearer token JWT (rol cliente);Error: {"timestamp":"2024-01-15T10:30:00","status":404,"error":"Not Found","message":"Solicitud no encontrada con número de seguimiento: SEG-INVALIDO","path":"/api-logistica/solicitudes/seguimiento-detallado/SEG-INVALIDO"};404;Debe retornar 404 si el número de seguimiento no existe.;
067;operador;servicio-logistica;GET;/api-logistica/solicitudes/pendientes;Listar contenedores pendientes de asignación;N/A;Bearer token JWT (rol operador);Lista de pendientes: [{"idContenedor":1,"codigoContenedor":"CONT-001","solicitudId":1,"numeroSeguimiento":"SEG-2024-001","estado":"PENDIENTE"}];200;Muestra solicitudes sin ruta asignada. Útil para dashboard de operador.;
068;operador;servicio-logistica;GET;/api-logistica/solicitudes/pendientes?estado=PENDIENTE&idContenedor=1;Listar pendientes con filtros;N/A;Bearer token JWT (rol operador);Lista filtrada por estado y contenedor;200;Permite filtrar por estado y/o idContenedor. Parámetros opcionales.;
069;transportista;servicio-logistica;GET;/api-logistica/tramos;Listar todos los tramos;N/A;Bearer token JWT (cualquier rol);Lista de tramos: [{"id":1,"idRuta":1,"origenDireccion":"Av. Colón 100","destinoDireccion":"Depósito Central","distanciaKm":3.5,"duracionEstimadaMinutos":10,"estado":"PENDIENTE","patenteCamion":null}];200;Debe incluir todos los tramos del sistema. Considerar paginación.;
070;transportista;servicio-logistica;GET;/api-logistica/tramos/1;Obtener tramo por ID;N/A;Bearer token JWT (cualquier rol);Tramo completo con todos los campos incluidos fechas y costos;200;ID debe existir. Incluye estadías calculadas si está FINALIZADO.;
071;transportista;servicio-logistica;GET;/api-logistica/tramos/ruta/1;Listar tramos de una ruta específica;N/A;Bearer token JWT (cualquier rol);Lista de tramos filtrados por idRuta = 1;200;Filtro WHERE id_ruta = 1. Muestra secuencia de tramos de la ruta.;
072;transportista;servicio-logistica;GET;/api-logistica/tramos/camion/AA123BB;Listar tramos asignados a un camión;N/A;Bearer token JWT (rol transportista);Lista de tramos donde patenteCamion = 'AA123BB';200;Transportista consulta qué tramos tiene asignados. Filtro por patente.;
073;transportista;servicio-logistica;GET;/api-logistica/tramos/estado/PENDIENTE;Listar tramos por estado;N/A;Bearer token JWT (cualquier rol);Lista de tramos con estado = 'PENDIENTE';200;Estados: PENDIENTE, EN_TRANSITO, FINALIZADO. Útil para asignación de camiones.;
074;operador;servicio-logistica;POST;/api-logistica/tramos;Crear nuevo tramo;{"idRuta":1,"origenDireccion":"Av. Colón 100","origenLatitud":-31.4200,"origenLongitud":-64.1888,"destinoDireccion":"Depósito Central","destinoLatitud":-31.3900,"destinoLongitud":-64.1600,"distanciaKm":5.5,"duracionEstimadaMinutos":18,"estado":"PENDIENTE"};Bearer token JWT (rol operador);Tramo creado: {"id":2,"idRuta":1,"estado":"PENDIENTE"};200;Validar que la ruta exista. Estado inicial debe ser PENDIENTE.;
075;operador;servicio-logistica;PUT;/api-logistica/tramos/1;Actualizar tramo existente;{"idRuta":1,"origenDireccion":"Av. Colón 100 Modificado","origenLatitud":-31.4200,"origenLongitud":-64.1888,"destinoDireccion":"Depósito Central","destinoLatitud":-31.3900,"destinoLongitud":-64.1600,"distanciaKm":5.8,"duracionEstimadaMinutos":20,"estado":"PENDIENTE"};Bearer token JWT (rol operador);Tramo actualizado;200;Validar que estado sea PENDIENTE. No se puede editar si está EN_TRANSITO o FINALIZADO.;
076;operador;servicio-logistica;DELETE;/api-logistica/tramos/1;Eliminar tramo existente;N/A;Bearer token JWT (rol operador);Cuerpo vacío (No Content);204;Validar que estado sea PENDIENTE. No se puede eliminar si está EN_TRANSITO.;
077;operador;servicio-logistica;PUT;/api-logistica/tramos/1/asignar-camion?patente=AA123BB&peso=1500&volumen=2.5;Asignar camión a tramo;N/A;Bearer token JWT (rol operador);Tramo actualizado: {"id":1,"patenteCamion":"AA123BB","estado":"PENDIENTE"};200;Valida capacidad del camión >= peso y volumen solicitados. Camión debe estar disponible.;
078;operador;servicio-logistica;PUT;/api-logistica/tramos/1/asignar-camion?patente=ZZ999ZZ&peso=1500&volumen=2.5;Asignar camión inexistente a tramo;N/A;Bearer token JWT (rol operador);Error: {"timestamp":"2024-01-15T10:30:00","status":404,"error":"Not Found","message":"Camión no encontrado con patente: ZZ999ZZ","path":"/api-logistica/tramos/1/asignar-camion"};404;Debe validar que el camión exista en servicio-flota (comunicación REST).;
079;operador;servicio-logistica;PUT;/api-logistica/tramos/1/asignar-camion?patente=AA123BB&peso=100000&volumen=2.5;Asignar camión con capacidad insuficiente;N/A;Bearer token JWT (rol operador);Error: {"timestamp":"2024-01-15T10:30:00","status":400,"error":"Bad Request","message":"El camión AA123BB no tiene capacidad suficiente para peso 100000.0 (capacidad: 5000.0)","path":"/api-logistica/tramos/1/asignar-camion"};400;Validación de negocio: capacidadPeso >= peso solicitado.;
080;transportista;servicio-logistica;PATCH;/api-logistica/tramos/1/iniciar;Iniciar tramo asignado;N/A;Bearer token JWT (rol transportista);Tramo iniciado: {"id":1,"estado":"EN_TRANSITO","fechaHoraInicio":"2024-01-15T10:30:00"};200;Cambia estado PENDIENTE → EN_TRANSITO. Registra fechaHoraInicio. Camión debe estar asignado.;
081;transportista;servicio-logistica;PATCH;/api-logistica/tramos/1/iniciar;Iniciar tramo sin camión asignado;N/A;Bearer token JWT (rol transportista);Error: {"timestamp":"2024-01-15T10:30:00","status":409,"error":"Conflict","message":"No se puede iniciar un tramo sin camión asignado","path":"/api-logistica/tramos/1/iniciar"};409;Validación de estado: patenteCamion != null requerido.;
082;transportista;servicio-logistica;PATCH;/api-logistica/tramos/1/iniciar;Iniciar tramo ya iniciado;N/A;Bearer token JWT (rol transportista);Error: {"timestamp":"2024-01-15T10:30:00","status":409,"error":"Conflict","message":"El tramo ya está en estado EN_TRANSITO","path":"/api-logistica/tramos/1/iniciar"};409;Validación de transición de estado: solo PENDIENTE → EN_TRANSITO es válida.;
083;transportista;servicio-logistica;PATCH;/api-logistica/tramos/1/finalizar?kmReales=5.8&costoKmCamion=150.0&consumoCamion=0.35;Finalizar tramo en tránsito;N/A;Bearer token JWT (rol transportista);Tramo finalizado: {"id":1,"estado":"FINALIZADO","fechaHoraFin":"2024-01-15T11:00:00","costoTotal":870.0,"estadiasDepositosTotal":0.0};200;Cambia estado EN_TRANSITO → FINALIZADO. Registra fechaHoraFin. Calcula costoTotal = kmReales * costoKmCamion. Calcula estadías si pasó por depósitos.;
084;transportista;servicio-logistica;PATCH;/api-logistica/tramos/1/finalizar?kmReales=5.8&costoKmCamion=150.0&consumoCamion=0.35;Finalizar tramo no iniciado;N/A;Bearer token JWT (rol transportista);Error: {"timestamp":"2024-01-15T10:30:00","status":409,"error":"Conflict","message":"Solo se pueden finalizar tramos en estado EN_TRANSITO","path":"/api-logistica/tramos/1/finalizar"};409;Validación de transición: solo EN_TRANSITO → FINALIZADO es válida.;
085;transportista;servicio-logistica;PATCH;/api-logistica/tramos/1/finalizar?kmReales=-5.8&costoKmCamion=150.0&consumoCamion=0.35;Finalizar tramo con km negativos;N/A;Bearer token JWT (rol transportista);Error: {"timestamp":"2024-01-15T10:30:00","status":400,"error":"Bad Request","message":"Los kilómetros reales deben ser mayores a 0","path":"/api-logistica/tramos/1/finalizar"};400;Validación de entrada: kmReales > 0 requerido.;
086;operador;servicio-logistica;GET;/api-logistica/rutas;Listar todas las rutas;N/A;Bearer token JWT (cualquier rol);Lista de rutas: [{"id":1,"idSolicitud":1,"distanciaKm":5.8,"duracionMinutos":15}];200;Debe incluir todas las rutas del sistema.;
087;operador;servicio-logistica;GET;/api-logistica/rutas/1;Obtener ruta por ID;N/A;Bearer token JWT (cualquier rol);Ruta completa: {"id":1,"idSolicitud":1,"distanciaKm":5.8,"duracionMinutos":15};200;ID debe existir.;
088;operador;servicio-logistica;GET;/api-logistica/rutas/solicitud/1;Listar rutas de una solicitud;N/A;Bearer token JWT (cualquier rol);Lista de rutas filtradas por idSolicitud = 1;200;Filtro WHERE id_solicitud = 1. Una solicitud puede tener múltiples rutas si se replanifica.;
089;operador;servicio-logistica;POST;/api-logistica/rutas;Crear nueva ruta;{"idSolicitud":1,"distanciaKm":5.8,"duracionMinutos":15};Bearer token JWT (rol operador);Ruta creada: {"id":2,"idSolicitud":1};200;Validar que la solicitud exista. Se crean tramos asociados en proceso separado.;
090;operador;servicio-logistica;PUT;/api-logistica/rutas/1;Actualizar ruta existente;{"idSolicitud":1,"distanciaKm":6.2,"duracionMinutos":18};Bearer token JWT (rol operador);Ruta actualizada;200;Permite ajustar métricas. Validar que no tenga tramos FINALIZADOS.;
091;operador;servicio-logistica;DELETE;/api-logistica/rutas/1;Eliminar ruta existente;N/A;Bearer token JWT (rol operador);Cuerpo vacío (No Content);204;Validar que no tenga tramos EN_TRANSITO. Eliminar en cascada tramos PENDIENTES.;
092;ANY;servicio-gestion;GET;/api-gestion/clientes;Acceso sin token JWT (No autorizado);N/A;Sin token Bearer;Error: {"timestamp":"2024-01-15T10:30:00","status":401,"error":"Unauthorized","message":"No se proporcionó token JWT o es inválido","path":"/api-gestion/clientes"};401;Spring Security debe bloquear acceso sin autenticación.;
093;ANY;servicio-flota;GET;/api-flota/camiones;Token JWT expirado;N/A;Bearer token EXPIRADO;Error: {"timestamp":"2024-01-15T10:30:00","status":401,"error":"Unauthorized","message":"El token JWT ha expirado","path":"/api-flota/camiones"};401;OAuth2 Resource Server valida exp claim del JWT.;
094;cliente;servicio-gestion;POST;/api-gestion/clientes;Token JWT con rol insuficiente (cliente intenta crear cliente);{"nombre":"Intruso","apellido":"Malicioso","email":"intruso@mail.com"};Bearer token JWT (rol cliente);Error: {"timestamp":"2024-01-15T10:30:00","status":403,"error":"Forbidden","message":"Acceso denegado. Se requiere rol: operador","path":"/api-gestion/clientes"};403;@PreAuthorize en controller debe verificar roles. Solo operador puede crear clientes.;
095;transportista;servicio-logistica;DELETE;/api-logistica/solicitudes/1;Token JWT con rol insuficiente (transportista intenta eliminar solicitud);N/A;Bearer token JWT (rol transportista);Error: {"timestamp":"2024-01-15T10:30:00","status":403,"error":"Forbidden","message":"Acceso denegado. Se requiere rol: operador","path":"/api-logistica/solicitudes/1"};403;Solo operador puede eliminar solicitudes. Transportista solo puede gestionar tramos asignados.;
096;operador;servicio-gestion;GET;/api-gestion/actuator/health;Endpoint de health check;N/A;N/A (público);{"status":"UP","components":{"db":{"status":"UP"},"diskSpace":{"status":"UP"}}};200;Endpoint público para monitoreo. No requiere autenticación.;
097;operador;servicio-flota;GET;/api-flota/actuator/metrics;Endpoint de métricas Actuator;N/A;Bearer token JWT (rol operador);Métricas de Micrometer: {"names":["jvm.memory.used","http.server.requests"]};200;Puede requerir autenticación según configuración. Útil para monitoreo APM.;
098;operador;ALL;GET;/api-*/swagger-ui/index.html;Acceso a Swagger UI;N/A;N/A (público o según config);Interfaz Swagger UI con documentación OpenAPI;200;SpringDoc debe estar habilitado. Puede ser público en dev, protegido en prod.;
099;operador;servicio-logistica;POST;/api-logistica/solicitudes/completa;Validación compleja: crear solicitud con email inválido en cliente;{"numeroSeguimiento":"SEG-2024-005","origenDireccion":"Origen","origenLatitud":-31.42,"origenLongitud":-64.19,"destinoDireccion":"Destino","destinoLatitud":-31.40,"destinoLongitud":-64.15,"clienteNombre":"Test","clienteApellido":"User","clienteEmail":"email-invalido","clienteTelefono":"351999","clienteCuil":"20999999999","contenedorCodigo":"CONT-007","contenedorPeso":1000.0,"contenedorVolumen":2.0};Bearer token JWT (rol operador);Error: {"timestamp":"2024-01-15T10:30:00","status":400,"error":"Bad Request","message":"El email del cliente debe ser válido","path":"/api-logistica/solicitudes/completa"};400;Validación @Email debe detectar formato inválido incluso en endpoint complejo con múltiples entidades.;
100;operador;servicio-logistica;PATCH;/api-logistica/tramos/1/finalizar?kmReales=10.5&costoKmCamion=150.0&consumoCamion=0.35;Validación de estadías: tramo con 3 días en depósito;N/A;Bearer token JWT (rol transportista);Tramo finalizado con estadías: {"id":1,"estado":"FINALIZADO","costoTotal":1575.0,"estadiasDepositosTotal":1500.0,"diasEstadia":3};200;Si el tramo pasó por depósito y hay diferencia de 3 días entre fechaHoraInicio y fechaHoraFin, se calculan estadías: 3 días * $500/día = $1500. Validar método calcularEstadiasEnDepositos().;
