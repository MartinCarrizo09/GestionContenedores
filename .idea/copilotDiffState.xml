<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="CopilotDiffPersistence">
    <option name="pendingDiffs">
      <map>
        <entry key="$PROJECT_DIR$/servicio-logistica/src/main/java/com/tpi/logistica/ejemplo/EjemplosGoogleMapsConfig.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/servicio-logistica/src/main/java/com/tpi/logistica/ejemplo/EjemplosGoogleMapsConfig.java" />
              <option name="updatedContent" value="package com.tpi.logistica.ejemplo;&#10;&#10;import com.tpi.logistica.dto.googlemaps.DistanciaYDuracion;&#10;import com.tpi.logistica.servicio.GoogleMapsService;&#10;import org.springframework.boot.CommandLineRunner;&#10;import org.springframework.context.annotation.Bean;&#10;import org.springframework.context.annotation.Configuration;&#10;import org.slf4j.Logger;&#10;import org.slf4j.LoggerFactory;&#10;&#10;/**&#10; * Configuración de ejemplo para pruebas de integración con Google Maps.&#10; * &#10; * Esta clase implementa CommandLineRunner para ejecutar ejemplos&#10; * automáticamente cuando inicia la aplicación (solo en desarrollo).&#10; * &#10; * Para activar estos ejemplos, descomenta el método ejemplosGoogleMaps()&#10; * &#10; * Propósito educativo: Demostrar cómo usar:&#10; * - RestClient inyectado en servicios&#10; * - Manejo de respuestas HTTP&#10; * - Conversión de DTOs&#10; * - Logging y trazabilidad&#10; */&#10;@Configuration&#10;public class EjemplosGoogleMapsConfig {&#10;&#10;    private static final Logger logger = LoggerFactory.getLogger(EjemplosGoogleMapsConfig.class);&#10;&#10;    /**&#10;     * NOTA: Este CommandLineRunner está comentado por defecto para evitar&#10;     * llamadas innecesarias a la API de Google Maps durante inicio.&#10;     * &#10;     * Para activar los ejemplos:&#10;     * 1. Descomenta el @Bean&#10;     * 2. Reinicia la aplicación&#10;     * 3. Verás los logs en consola con los resultados&#10;     */&#10;    /*&#10;    @Bean&#10;    public CommandLineRunner ejemplosGoogleMaps(GoogleMapsService googleMapsService) {&#10;        return args -&gt; {&#10;            logger.info(&quot;\n\n╔════════════════════════════════════════════════════════════════╗&quot;);&#10;            logger.info(&quot;║     EJEMPLOS DE INTEGRACIÓN CON GOOGLE MAPS REST CLIENT    ║&quot;);&#10;            logger.info(&quot;╚════════════════════════════════════════════════════════════════╝\n&quot;);&#10;&#10;            try {&#10;                // ========== EJEMPLO 1: Distancia entre ciudades argentinas ==========&#10;                logger.info(&quot; EJEMPLO 1: Distancia entre direcciones&quot;);&#10;                logger.info(&quot;─────────────────────────────────────────────────────────────────&quot;);&#10;                &#10;                DistanciaYDuracion distancia1 = googleMapsService&#10;                    .calcularDistanciaYDuracion(&#10;                        &quot;Córdoba, Argentina&quot;,&#10;                        &quot;Buenos Aires, Argentina&quot;&#10;                    );&#10;&#10;                logger.info(&quot;Origen: {}&quot;, distancia1.getOrigenDireccion());&#10;                logger.info(&quot;Destino: {}&quot;, distancia1.getDestinoDireccion());&#10;                logger.info(&quot;Distancia: {} ({} km)&quot;, &#10;                    distancia1.getDistanciaTexto(), &#10;                    String.format(&quot;%.2f&quot;, distancia1.getDistanciaKm()));&#10;                logger.info(&quot;Duración: {} ({} horas)&quot;, &#10;                    distancia1.getDuracionTexto(), &#10;                    String.format(&quot;%.2f&quot;, distancia1.getDuracionHoras()));&#10;&#10;                // ========== EJEMPLO 2: Distancia por coordenadas ==========&#10;                logger.info(&quot;\n EJEMPLO 2: Distancia usando coordenadas&quot;);&#10;                logger.info(&quot;─────────────────────────────────────────────────────────────────&quot;);&#10;                &#10;                // Coordenadas: Córdoba → La Plata&#10;                DistanciaYDuracion distancia2 = googleMapsService&#10;                    .calcularDistanciaPorCoordenadas(&#10;                        -31.4167, -64.1833,   // Córdoba&#10;                        -34.9215, -57.9545    // La Plata&#10;                    );&#10;&#10;                logger.info(&quot;Origen: {}&quot;, distancia2.getOrigenDireccion());&#10;                logger.info(&quot;Destino: {}&quot;, distancia2.getDestinoDireccion());&#10;                logger.info(&quot;Distancia: {} ({} km)&quot;, &#10;                    distancia2.getDistanciaTexto(), &#10;                    String.format(&quot;%.2f&quot;, distancia2.getDistanciaKm()));&#10;&#10;                // ========== EJEMPLO 3: Uso en cálculo de tarifa comercial ==========&#10;                logger.info(&quot;\n EJEMPLO 3: Cálculo de tarifa basado en distancia&quot;);&#10;                logger.info(&quot;─────────────────────────────────────────────────────────────────&quot;);&#10;                &#10;                Double precioKm = 15.0;          // $15 por km&#10;                Double recargoHora = 50.0;       // $50 por hora&#10;                &#10;                Double tarifa = (distancia1.getDistanciaKm() * precioKm) &#10;                              + (distancia1.getDuracionHoras() * recargoHora);&#10;                &#10;                logger.info(&quot;Tarifa por km: ${}&quot;, precioKm);&#10;                logger.info(&quot;Recargo por hora: ${}&quot;, recargoHora);&#10;                logger.info(&quot;Subtotal km: ${}&quot;, String.format(&quot;%.2f&quot;, distancia1.getDistanciaKm() * precioKm));&#10;                logger.info(&quot;Subtotal horas: ${}&quot;, String.format(&quot;%.2f&quot;, distancia1.getDuracionHoras() * recargoHora));&#10;                logger.info(&quot;TARIFA TOTAL: ${}&quot;, String.format(&quot;%.2f&quot;, tarifa));&#10;&#10;                logger.info(&quot;\n✅ Todos los ejemplos ejecutados exitosamente\n&quot;);&#10;&#10;            } catch (RuntimeException e) {&#10;                logger.error(&quot;❌ Error durante ejemplos: {}&quot;, e.getMessage());&#10;                logger.error(&quot;Verificá que:&quot;, e);&#10;                logger.error(&quot;1. La API key de Google Maps está configurada en application.properties&quot;);&#10;                logger.error(&quot;2. La API key tiene habilitada la Distance Matrix API&quot;);&#10;                logger.error(&quot;3. Hay conexión a internet&quot;);&#10;            }&#10;        };&#10;    }&#10;    */&#10;}&#10;&#10;/**&#10; * GUÍA PARA USAR ESTOS EJEMPLOS EN PRODUCCIÓN:&#10; * &#10; * 1. NO incluyas ejemplos en CommandLineRunner en producción&#10; * 2. USA el GoogleMapsService en tus servicios reales:&#10; * &#10; *    @Service&#10; *    public class CreacionPedidoServicio {&#10; *        private final GoogleMapsService googleMapsService;&#10; *        &#10; *        public void crearPedido(Pedido pedido) {&#10; *            // Calcula distancia real&#10; *            DistanciaYDuracion distancia = googleMapsService&#10; *                .calcularDistanciaYDuracion(pedido.getOrigen(), pedido.getDestino());&#10; *            &#10; *            // Usa la información&#10; *            pedido.setDistanciaKm(distancia.getDistanciaKm());&#10; *            pedido.setTarifa(calcularTarifa(distancia));&#10; *            &#10; *            pedidoRepository.save(pedido);&#10; *        }&#10; *    }&#10; * &#10; * 3. MANEJO DE ERRORES:&#10; *    - Captura RuntimeException del servicio&#10; *    - Retorna errores 400/500 al cliente REST&#10; *    - Loguea para debugging&#10; * &#10; * 4. TESTING:&#10; *    - Mock el RestClient en tests unitarios&#10; *    - No llames a Google Maps en tests&#10; *    &#10; *    @Mock&#10; *    private RestClient restClient;&#10; *    &#10; *    @InjectMocks&#10; *    private GoogleMapsService googleMapsService;&#10; * &#10; * 5. PERFORMANCE:&#10; *    - RestClient es sincrónico (bloquea el thread)&#10; *    - Para muchas llamadas concurrentes, considera usar WebClient (reactivo)&#10; *    - Implementa caché si consultas las mismas rutas repetidamente&#10; */&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
      </map>
    </option>
  </component>
</project>